準同型暗号マスキング方式 統合テスト開始（all）
日時: 2025年05月14日 17:50:47

テスト設定:
- テストタイプ: all
- 出力ディレクトリ: test_output
- 真のテストファイル: common/true-false-text/t.text
- 偽のテストファイル: common/true-false-text/f.text
- 鍵サイズ: 1024ビット
- チャンクサイズ: 64バイト

## テスト環境情報
- Python バージョン: 3.12.8 (v3.12.8:2dc476bcb91, Dec  3 2024, 14:43:20) [Clang 13.0.0 (clang-1300.0.29.30)]
- OS: posix
- ワーキングディレクトリ: /Users/dev/works/VSCode/secret-sharing-demos-20250510


================================================================================
# 準同型暗号の基本機能テスト
================================================================================


## テストファイルの読み込み
[2025-05-14 17:50:47] テストファイル読み込み完了:
[2025-05-14 17:50:47]   真テキストサイズ: 300バイト
[2025-05-14 17:50:47]   偽テキストサイズ: 300バイト

## 暗号化処理
[2025-05-14 17:50:47] 準同型暗号システムを初期化中...
[2025-05-14 17:50:47] 公開鍵生成完了: n=99887718140621454137103951541435903051548180467279847122780202845033691117314873537823898901673256307586719801677251053126683799300398886330508132346743235930893787558181664375229194750471692585846308153484627870870149768532264867055954067598008053519572190360039393871853533246610575311024365125835724372911, g=99887718140621454137103951541435903051548180467279847122780202845033691117314873537823898901673256307586719801677251053126683799300398886330508132346743235930893787558181664375229194750471692585846308153484627870870149768532264867055954067598008053519572190360039393871853533246610575311024365125835724372912
[2025-05-14 17:50:47] 真偽判別用の鍵を生成中...
[2025-05-14 17:50:47] 鍵生成完了:
[2025-05-14 17:50:47]   真鍵: ea02b9b8bb2c6800ab9e7723d900808295af1e779509f219ff58659121d66666
[2025-05-14 17:50:47]   偽鍵: ac30642b003557d3b3e74d2ed8d2c1094c5e78f12e0db4818eabc4e09ac48678
[2025-05-14 17:50:47] データを前処理中...
[2025-05-14 17:50:47] 前処理完了:
[2025-05-14 17:50:47]   真データタイプ: text, サイズ: 429バイト
[2025-05-14 17:50:47]   偽データタイプ: text, サイズ: 429バイト
[2025-05-14 17:50:47] チャンク分割完了:
[2025-05-14 17:50:47]   真チャンク数: 7
[2025-05-14 17:50:47]   偽チャンク数: 7
[2025-05-14 17:50:48] 暗号化完了:
[2025-05-14 17:50:48]   真暗号化チャンク数: 7
[2025-05-14 17:50:48]   偽暗号化チャンク数: 7
[2025-05-14 17:50:48] マスク関数を生成中...
[2025-05-14 17:50:48] マスク関数を適用して真偽チャンクを変換中...
[2025-05-14 17:50:48] 暗号文を識別不能な形式に変換中...
[2025-05-14 17:50:48] 暗号化データを保存中: test_output/basic_test/encrypted_20250514-175047.json
[2025-05-14 17:50:48] 暗号化データを保存しました: サイズ=9887バイト

## 真鍵での復号
[2025-05-14 17:50:48] 真鍵用のデータを抽出中...
[2025-05-14 17:50:48] マスクを除去中...
[2025-05-14 17:50:48] 復号中...
[2025-05-14 17:50:48] 真鍵データの後処理中... データタイプ: text
[2025-05-14 17:50:48] 真鍵での復号データを保存中: test_output/basic_test/decrypted_true_20250514-175047.txt

## 偽鍵での復号
[2025-05-14 17:50:48] 偽鍵用のデータを抽出中...
[2025-05-14 17:50:48] マスクを除去中...
[2025-05-14 17:50:48] 復号中...
[2025-05-14 17:50:48] 偽鍵データの後処理中... データタイプ: text
[2025-05-14 17:50:48] 偽鍵での復号データを保存中: test_output/basic_test/decrypted_false_20250514-175047.txt

## 復号結果の検証
[2025-05-14 17:50:48] 真ファイルのハッシュ比較: False
[2025-05-14 17:50:48]   元のハッシュ:   088f5b0bbab0b70a3b992763d4138ad25630fff6853eab15e63602a513139d6a
[2025-05-14 17:50:48]   復号後のハッシュ: 937991d5aa79d11c0dd2c46b1f8b63cf9d6fabb064d263238c1c887eabbd2900
[2025-05-14 17:50:48] 偽ファイルのハッシュ比較: False
[2025-05-14 17:50:48]   元のハッシュ:   b55cd667cee3c8d3b7ba07181912dd974f62b5b9a13a35198a052dcb960bccba
[2025-05-14 17:50:48]   復号後のハッシュ: 17ca83bf61cf2b0374c845e871300cb9c79feefa13f94d737ec5dc90c7281886
[2025-05-14 17:50:48] テスト結果: 失敗

================================================================================
# マスク関数テスト
================================================================================


## 準同型暗号の初期化
[2025-05-14 17:50:48] 公開鍵生成完了: n=102806513155603138310448620293829768608877829627474363002572425637098972366241914328183987648087497729500608940764940771135574844563436410223844250936719630794394009050376294789057866980550310534276473753483951573629894204075590079535882259777831285490466197860862363634134911243507308119500625103099345740361, g=102806513155603138310448620293829768608877829627474363002572425637098972366241914328183987648087497729500608940764940771135574844563436410223844250936719630794394009050376294789057866980550310534276473753483951573629894204075590079535882259777831285490466197860862363634134911243507308119500625103099345740362

## 基本マスク関数テスト
[2025-05-14 17:50:48] 基本マスク関数を生成しました
[2025-05-14 17:50:48]   真マスク: {'type': 'true_mask', 'params': {'additive': [3746305527, 2935816808, 1400320288, 3412132270], 'multiplicative': [1027005269, 1334495117, 1549551878, 964789602]}, 'seed': '2qmrMNzNUfEgmKJ9S78AShUOhxQPzZ/W0yNk+SyJaP0='}
[2025-05-14 17:50:48]   偽マスク: {'type': 'false_mask', 'params': {'additive': [721134817, 2342297695, 1034111225, 1677543257], 'multiplicative': [286801613, 3732974265, 4056208744, 701804011]}, 'seed': '2qmrMNzNUfEgmKJ9S78AShUOhxQPzZ/W0yNk+SyJaP0='}
[2025-05-14 17:50:48] 基本マスクを適用しました
[2025-05-14 17:50:48] 基本マスク関数テスト結果: 成功

## 高度マスク関数テスト
[2025-05-14 17:50:48] 高度マスク関数を生成しました
[2025-05-14 17:50:48] 高度マスクを適用しました
[2025-05-14 17:50:48] 高度マスク関数テスト結果: 成功

## マスクの統計的特性テスト
[2025-05-14 17:50:48] 基本マスクの統計:
[2025-05-14 17:50:48]   加算パラメータ平均: 2182091749.23
[2025-05-14 17:50:48]   加算パラメータ分散: 1.5657348943442785e+18
[2025-05-14 17:50:48]   乗算パラメータ平均: 2173773288.5675
[2025-05-14 17:50:48]   乗算パラメータ分散: 1.413428036218857e+18
[2025-05-14 17:50:48] 高度マスクの統計:
[2025-05-14 17:50:48]   加算パラメータ平均: 1990300010.9675
[2025-05-14 17:50:48]   加算パラメータ分散: 1.5115693290158177e+18
[2025-05-14 17:50:48]   乗算パラメータ平均: 2112353139.45
[2025-05-14 17:50:48]   乗算パラメータ分散: 1.596003035313804e+18
[2025-05-14 17:50:48] エラーが発生しました: unhashable type: 'dict'
[2025-05-14 17:50:48] Traceback (most recent call last):
  File "/Users/dev/works/VSCode/secret-sharing-demos-20250510/method_8_homomorphic/homomorphic_test.py", line 766, in test_masking_functions
    plt.hist(basic_masks, bins=20, alpha=0.7, label='基本マスク')
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/_api/deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/pyplot.py", line 3478, in hist
    return gca().hist(
           ^^^^^^^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/_api/deprecation.py", line 453, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/__init__.py", line 1521, in inner
    return func(
           ^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/axes/_axes.py", line 7050, in hist
    x = [*self._process_unit_info([("x", x[0])], kwargs),
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/axes/_base.py", line 2653, in _process_unit_info
    axis.update_units(data)
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/axis.py", line 1754, in update_units
    default = self._converter.default_units(data, self)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/category.py", line 106, in default_units
    axis.set_units(UnitData(data))
                   ^^^^^^^^^^^^^^
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/category.py", line 182, in __init__
    self.update(data)
  File "/Users/dev/Library/Python/3.12/lib/python/site-packages/matplotlib/category.py", line 215, in update
    for val in OrderedDict.fromkeys(data):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'


================================================================================
# セキュリティ特性テスト
================================================================================


## 暗号文識別不能性テスト
[2025-05-14 17:50:48] 暗号化テスト 1/3 を実行...
[2025-05-14 17:50:49] 暗号化ファイル 1 のハッシュ: 3c7a02044949fcf7...
[2025-05-14 17:50:49] 暗号化テスト 2/3 を実行...
[2025-05-14 17:50:49] 暗号化ファイル 2 のハッシュ: b336c9b74d883a45...
[2025-05-14 17:50:49] 暗号化テスト 3/3 を実行...
[2025-05-14 17:50:49] 暗号化ファイル 3 のハッシュ: b5eaa8f24f672a0c...
[2025-05-14 17:50:49] 暗号文識別不能性テスト: 合格
[2025-05-14 17:50:49]   3回の暗号化で得られたユニークなハッシュ数: 3

## 鍵解析テスト
[2025-05-14 17:50:49] テスト鍵生成:
[2025-05-14 17:50:49]   真鍵: 87f2bdafbc9148e7...
[2025-05-14 17:50:49]   偽鍵: 433aceb37d864e63...
[2025-05-14 17:50:49] 鍵解析テスト:
[2025-05-14 17:50:49]   真鍵の解析結果: false
[2025-05-14 17:50:49]   偽鍵の解析結果: false
[2025-05-14 17:50:51] 鍵解析結果分布（50サンプル）:
[2025-05-14 17:50:51]   真鍵と判定: 15 (30.0%)
[2025-05-14 17:50:51]   偽鍵と判定: 35 (70.0%)
[2025-05-14 17:50:51]   その他の判定: 0 (0.0%)
[2025-05-14 17:50:51] 鍵解析分布テスト: 不合格
[2025-05-14 17:50:51]   分布バランス: 0.400
[2025-05-14 17:50:51] 鍵分布グラフを保存しました: test_output/security_test/key_distribution_20250514-175047.png

## タイミング攻撃耐性テスト
[2025-05-14 17:50:51] タイミング攻撃耐性テストでエラーが発生しました: 'seed'

================================================================================
# パフォーマンステスト
================================================================================


## 鍵生成パフォーマンス
[2025-05-14 17:50:51] 512ビット鍵の生成時間を測定...
[2025-05-14 17:50:51]   512ビット鍵の生成時間: 0.012657秒
[2025-05-14 17:50:51] 1024ビット鍵の生成時間を測定...
[2025-05-14 17:50:51]   1024ビット鍵の生成時間: 0.015166秒
[2025-05-14 17:50:51] 2048ビット鍵の生成時間を測定...
[2025-05-14 17:50:53]   2048ビット鍵の生成時間: 2.313839秒

## 暗号化パフォーマンス（サイズ別）
[2025-05-14 17:50:53] 100バイトのデータで暗号化時間を測定...
[2025-05-14 17:50:53]   100バイト暗号化時間: 0.052344秒
[2025-05-14 17:50:53] 1000バイトのデータで暗号化時間を測定...
[2025-05-14 17:50:54]   1000バイト暗号化時間: 0.422713秒
[2025-05-14 17:50:54] 10000バイトのデータで暗号化時間を測定...
[2025-05-14 17:50:58]   10000バイト暗号化時間: 4.287411秒

## 復号パフォーマンス（サイズ別）
[2025-05-14 17:51:02] 100バイトのデータで復号時間を測定...
[2025-05-14 17:51:02]   100バイト復号時間: 0.056949秒
[2025-05-14 17:51:02] 1000バイトのデータで復号時間を測定...
[2025-05-14 17:51:03]   1000バイト復号時間: 0.443000秒
[2025-05-14 17:51:03] 10000バイトのデータで復号時間を測定...
[2025-05-14 17:51:07]   10000バイト復号時間: 4.546526秒

## スケーリング特性
[2025-05-14 17:51:07] 鍵サイズ 512ビット, データサイズ 1000バイトのスケーリングテスト...
[2025-05-14 17:51:07]   暗号化時間: 0.041673秒, 復号時間: 0.029149秒
[2025-05-14 17:51:07] 鍵サイズ 1024ビット, データサイズ 1000バイトのスケーリングテスト...
[2025-05-14 17:51:08]   暗号化時間: 0.204173秒, 復号時間: 0.184571秒

## パフォーマンスグラフ生成
[2025-05-14 17:51:08] パフォーマンスグラフを保存しました: test_output/performance_test/performance_graph_20250514-175108.png
[2025-05-14 17:51:08] パフォーマンスデータを保存しました: test_output/performance_test/performance_data_20250514-175108.json

================================================================================
# テスト結果レポートの生成
================================================================================

[2025-05-14 17:51:08] テスト結果レポートを保存しました: test_output/homomorphic_test_report_20250514-175108.md
## テスト完了
- 合計実行時間: 21.03秒
- テスト結果レポート: test_output/homomorphic_test_report_20250514-175108.md
- 成功したテスト: 1/4
### 一部のテストが失敗しました ❌
