## 機能要件

### 1. 多重暗号化ストリーム生成 🌊

- **拡張ラビットアルゴリズム**を実装し、RFC4503 準拠の基本設計を超えた多重ストリーム生成を実現
- スタンダードラビット暗号の内部状態（256 ビット）を**拡張格子空間**（1024 ビット）に射影
- 各ストリームは数学的に無相関であることを**ガロア体 GF(2^128)上で証明可能**な設計
- 非線形関数適用前に**準同型射影変換**を挿入し、両暗号方式の数学的互換性を確保
- 疑似ランダム関数の性質を満たし、区別不可能性を保証すること

### 2. 準同型マスク適用 🎭

- 復号過程で生成される平文に**部分準同型演算**でマスクを適用
- マスクは**ラビットストリームの内部状態と連動**して生成され、両方式が不可分に結合
- 加法準同型性と**制限付き乗法準同型性**を実現する**特殊環構造**を導入
- マスク適用は**可換環上の同型写像**として定義され、数学的に追跡不可能
- **格子基底ローテーション技術**により、マスク適用後も暗号文の統計的性質を保存

### 3. 不区別性の実現 🔍

- **計算量的不区別性**の数学的証明が可能な設計
- **準同型理論とストリーム暗号理論の交差領域**における新しい安全性定理に基づく設計
- どの多項式時間攻撃者も正規/非正規暗号文を識別する確率が**1/2+ε**（ε は無視可能）となる
- 暗号理論の識別不能性（**IND-CPA**）と同等の安全性を確保
- **決定木不可能定理**による数学的証明：どんなアルゴリズムも決定不能問題に帰着

### 4. 確率的カプセル化 🎲

- 復号プロセスに**準同型保存確率変数**を導入し、実行ごとに内部状態が変化
- NIST 認定の**CSPRNG**（暗号学的擬似乱数生成器）を使用
- 同一入力に対して**毎回異なる実行経路**を確保
- **ラビットストリームのジャンプ関数**と**準同型演算の確率的選択**を組み合わせて実行パスを多様化
- 確率変数が**準同型性を保存**する特殊設計により、セキュリティと機能性を両立

### 5. 自己診断とログ機能 📊

- 各モジュールは自己診断機能を内蔵し、異常を検出・記録できること
- 内部状態と処理フローを詳細にログ出力する機能を持つこと
- ログレベルを設定可能とし、運用/開発/デバッグの各モードに対応すること
- 診断結果は標準化されたフォーマットで出力され、自動テストで解析可能なこと
- **全てのログファイルはタイムスタンプを含んだ一意のファイル名で出力し、上書きが発生しない設計とすること**
- **検証時に生成される画像や分析データも同様にタイムスタンプ付きで保存し、過去データとの比較を可能にすること**

### 6. データアダプタと多段エンコーディング 📄

- **複数のデータ形式に対応すること：**

  - UTF8 テキスト文書
  - CSV データ
  - JSON データ
  - バイナリーデータ

- **ファイル形式の自動判定機能：**

  - 入力ファイルのデータ形式を自動的に判定
  - バイナリ/テキスト/JSON/Base64 などを特性から識別
  - 判定結果に基づいて最適な処理方法を選択

- **多段エンコーディング処理：**
  - 暗号化前に適切な多段エンコーディングを適用
  - 基本フロー: `元データ→データ判定→多段エンコード→暗号化→復号→多段デコード→元形式に復元`
  - テキスト形式には UTF-8 → Latin-1 → Base64 の多段変換を適用
  - 元のデータ形式情報を保持し、復号後に正確に元の形式に復元
