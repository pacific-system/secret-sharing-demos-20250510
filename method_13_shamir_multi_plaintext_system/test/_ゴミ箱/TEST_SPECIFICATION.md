# シャミア秘密分散法による複数平文復号システム テスト仕様書 v1.0

## 1. テスト目的 [ID:TEST-PURPOSE]

シャミア秘密分散法による複数平文復号システムの実装が、仕様通りに動作することを検証するためのテストフレームワークを提供します。このテストは、セキュリティ要件と機能要件の両方を検証します。

## 2. テスト規約 [ID:TEST-CONVENTIONS]

### 2.1 テスト実行規約 [ID:EXEC-RULES]

- RULE-2.1.1: テスト完了後、`/method_13_shamir_multi_plaintext_system/IMPLEMENTATION_NOTES.md` のフォーマットに準じたレポートを `/method_13_shamir_multi_plaintext_system/tests/test_report` ディレクトリに生成する
- RULE-2.1.2: テストはメインモジュールからレポートに必要なコンポーネントを読み込んで実行する
- RULE-2.1.3: 毎回のテスト実行ではレポート項目の全てをテストする
- RULE-2.1.4: テストに採用する値は `/method_13_shamir_multi_plaintext_system/shamir/constants.py` のみを使用する
- **RULE-2.1.5 [重大]: 希望的観測に基づくレポート作成の禁止** - テストレポートは、必ず実際のテスト実行の結果に基づいて作成すること。事前にレポートを作成しておき、その後でテストを実行するという順序は、以下の理由により**厳格に禁止**する：

  1. テスト結果の信頼性と完全性が損なわれる
  2. 実際の問題が覆い隠され、偽陽性の結果が増える
  3. 暗号システムのセキュリティ保証が損なわれる
  4. トレーサビリティと監査証跡の信頼性が失われる
  5. コンプライアンス違反となりうる

  テスト実行とレポート生成の正しい順序は：

  1. テスト計画の作成
  2. テストコードの準備
  3. テスト実行
  4. 結果の収集と分析
  5. テストレポートの作成

- **RULE-2.1.6: CLI データの一時保存** - テスト実行時に CLI から取得したデータ（パーティションマップキーや MAP 配列など）は再現性と検証のために一時保存する。

  1. 保存は一時ディレクトリ内の専用サブディレクトリに行う
  2. ファイル名には UUID を含め、一意性を確保する
  3. データファイルは JSON 形式で保存し、後続の検証で利用可能にする
  4. データファイルには以下の情報を含む：
     - パーティションマップキー
     - 分配された MAP 配列のシェア ID
     - パスワードハッシュ値（セキュリティのため平文パスワードは保存しない）
     - システムパラメータ（PARTITION_SIZE, ACTIVE_SHARES）
  5. テストレポート生成時に、データファイルをレポートディレクトリにコピーし、レポート内に参照情報を記載する

### 2.2 テストレポート命名規則 [ID:REPORT-NAMING]

テストレポートのファイル名は以下の形式とする：

```
test_report_{YYYYMMDD}_{HHMMSS}.md
```

例：`test_report_20250510_123045.md`

### 2.3 テスト実行方法に関する規約 [ID:TEST-METHOD-RULES]

- RULE-2.3.1: テストは実際の CLI に引数を渡した結果で実行すること
- RULE-2.3.2: コードのバイパスを行ったり、バックドアを設けて結果を偽装することは禁止する
- RULE-2.3.3: 全てのテストは実際のシステム動作を正確に反映する形で実施すること
- RULE-2.3.4: モックやスタブの使用は、外部依存のあるコンポーネントに限定し、コア機能のテストでは使用しないこと

### 2.4 テスト失敗時の対応規約 [ID:FAILURE-HANDLING]

- RULE-2.4.1: テスト失敗時は、すぐに修正を開始せず、まず失敗の事実をレポートに詳細に記載すること
- RULE-2.4.2: 失敗レポートには以下の内容を含めること：

  1. 失敗したテストの名称とパラメータ
  2. 期待された結果と実際の結果の差異
  3. その時点で把握できる原因分析
  4. 推奨される対策案（複数ある場合は優先順位付け）
  5. 関連する可能性のある他の機能への影響

- **重要警告**: 安直にテストの失敗に対する修正を行うことは厳禁とする。理由：

  1. 暗号システムでは表面的な修正が深刻なセキュリティホールを生み出す可能性がある
  2. 複雑に絡み合った依存関係により、一部の修正が他の機能に予期せぬ影響を与える
  3. シャミア秘密分散法のような数学的基盤に基づくシステムでは、安易な修正が暗号学的安全性を損なう恐れがある
  4. 失敗の根本原因を特定せずに行った修正は、同様の問題を別の形で再発させる

- RULE-2.4.3: テスト失敗への対応は、以下のプロセスに従うこと：
  1. 完全な失敗レポートの作成
  2. セキュリティ担当者とアーキテクトによるレビュー
  3. 対策案の数学的・セキュリティ的検証
  4. 承認された修正の実装
  5. 修正後の完全な再テスト

### 2.5 テストコンポーネント管理規約 [ID:COMPONENT-MANAGEMENT]

- RULE-2.5.1: テスト中に生成される全てのコンポーネント（クラス、モジュール、ファイル）には、明確な責務を次の形式でコメントとして記載すること：

  ```python
  """
  【責務】
  このコンポーネントは...（具体的な責務の説明）

  【依存関係】
  - 依存コンポーネント1: 依存内容の説明
  - 依存コンポーネント2: 依存内容の説明

  【使用方法】
  使用方法の簡潔な説明
  """
  ```

- RULE-2.5.2: 新規コンポーネントを生成する前に、類似の機能を持つ既存コンポーネントがないか以下の方法で確認すること：

  1. 既存のテストファイル一覧の確認
  2. 機能名やクラス名による検索
  3. 既存コンポーネントのドキュメントレビュー

- RULE-2.5.3: 既存コンポーネントが発見された場合は、次の優先順位で対応すること：

  1. 既存コンポーネントの再利用（最優先）
  2. 既存コンポーネントの機能拡張（必要に応じて）
  3. 既存コンポーネントのリファクタリング（重複機能の排除）

- RULE-2.5.4: 新規コンポーネント生成の結果、不要となったコンポーネントは以下のディレクトリに移動すること：

  ```
  /Users/dev/works/VSCode/secret-sharing-demos-20250510/method_13_shamir_multi_plaintext_system/tests/trash
  ```

- RULE-2.5.5: 移動されたコンポーネントには、次の情報をコメントとして追加すること：

  ```python
  """
  【廃止情報】
  廃止日時: YYYY-MM-DD HH:MM
  代替コンポーネント: 新しいコンポーネント名
  廃止理由: 具体的な理由
  """
  ```

- RULE-2.5.6: コンポーネント生成・廃止の履歴は、テストレポートの一部として記録し、トレーサビリティを確保すること

## 3. テスト範囲 [ID:TEST-SCOPE]

### 3.1 現在のテスト対象機能 [ID:CURRENT-SCOPE]

現在のテスト対象は以下の機能のみです：

1. 暗号書庫生成（createCryptoStorage）[ID:FUNC-CREATE-STORAGE]
   - **機能テスト** [ID:FUNC-CREATE-TESTS]
     - パーティション分割 [TEST-ID:FUNC-CREATE-PARTITION]
     - パーティションマップキー生成 [TEST-ID:FUNC-CREATE-MAPKEY]
     - ガベージシェア配置 [TEST-ID:FUNC-CREATE-GARBAGE]
     - 第 1 段階 MAP 生成 [TEST-ID:FUNC-CREATE-MAP1]
   - **セキュリティテスト** [ID:SEC-CREATE-TESTS]
     - 統計的区別不可能性検証 [TEST-ID:SEC-CREATE-INDISTINGUISHABILITY]: ガベージシェアと有効シェアが統計的に区別不可能であることを確認
     - タイミング攻撃耐性 [TEST-ID:SEC-CREATE-TIMING]: 暗号書庫生成プロセスが入力パラメータによらず一定時間で完了することを検証
     - パターン認識耐性 [TEST-ID:SEC-CREATE-PATTERN]: 生成されたシェア値や配置パターンに統計的な偏りがないか検証
     - 異常入力耐性 [TEST-ID:SEC-CREATE-INVALID]: 不正な入力パラメータに対して適切にエラー処理されることを確認

**注意**: 暗号書庫生成（createCryptoStorage）のテスト内容と期待される結果は、`/method_13_shamir_multi_plaintext_system/tests/test_report_template.md` に定義されている形式に従って評価・報告されます。

### 3.2 現在のテスト範囲外の機能 [ID:OUT-OF-SCOPE]

以下の機能は現在テスト範囲外です：

1. **暗号書庫更新（updateCryptoStorage）** [ID:FUNC-UPDATE-STORAGE]

   - 多段エンコード [ID:FUNC-UPDATE-ENCODE]
   - シャミア法シェア生成 [ID:FUNC-UPDATE-SHARE]
   - 第 2 段階 MAP 生成 [ID:FUNC-UPDATE-MAP2]
   - シェア配置 [ID:FUNC-UPDATE-PLACEMENT]
   - バックアップ処理 [ID:FUNC-UPDATE-BACKUP]

2. **暗号書庫読取（readCryptoStorage）** [ID:FUNC-READ-STORAGE]

   - シェア選択 [ID:FUNC-READ-SELECT]
   - シャミア法復元 [ID:FUNC-READ-RECONSTRUCT]
   - 多段デコード [ID:FUNC-READ-DECODE]
   - JSON 復元 [ID:FUNC-READ-JSON]

3. **シェア閾値検証（閾値スキームの安全性検証）** [ID:THRESHOLD-VERIFICATION]
   - **重要注意事項**: 完全なシェア閾値検証を実施するには、実際にデータを書き込み（updateCryptoStorage）、読み取る（readCryptoStorage）必要があります。これらの機能は現在のテスト範囲外であるため、完全な閾値検証は将来的なテストフェーズで実施されます
   - シェア閾値に関する制約 [ID:THRESHOLD-CONSTRAINTS]
     - 本システムでは、全てのシェアが揃わないと復元できない機能のみを提供します（n, n スキーム）
     - 部分的なシェア集合からの秘密復元機能は意図的に実装していません
     - この制約の完全な検証は、暗号書庫更新（updateCryptoStorage）と暗号書庫読取（readCryptoStorage）の機能が実装された後のテストフェーズで行われます
   - セキュリティリスク監視 [ID:THRESHOLD-SECURITY-MONITORING]
     - 現在のテストフェーズでは、シャミア法の理論的な性質に基づいたコード実装の検証のみを行います
     - 実際のデータ復元による検証は、将来的なテストフェーズに延期されます
   - **重要セキュリティ警告** [ID:THRESHOLD-SECURITY-ALERT]
     - 一部のシェアだけで復号を可能にするようなバックドア、ショートカット、または弱点を発見した場合は、**直ちにテスト実行を中断し、緊急セキュリティレポート**を作成すること
     - 緊急レポートは以下の内容を含める必要があります：
       1. 発見されたバックドア/弱点の詳細な技術的説明
       2. 再現手順（正確かつ詳細に）
       3. セキュリティ影響の評価（機密性、完全性、可用性への影響）
       4. 悪用難易度の評価
       5. 緩和策の提案
     - 緊急セキュリティレポートは「**SECURITY*ALERT_THRESHOLD_BYPASS*{YYYYMMDD}.md**」という命名規則で作成し、標準テストレポートとは別に保存すること

これらの機能は、暗号書庫生成機能が正常に動作することを確認した後、将来的なテストフェーズで検証される予定です。

### 3.3 将来的な統合テスト計画（現在範囲外） [ID:FUTURE-TESTS]

以下の統合テストは、すべての基本機能のテストが完了した後に実施予定です：

1. A 領域書込・読取テスト [ID:INT-TEST-A]

   - テスト依存関係: [FUNC-CREATE-STORAGE], [FUNC-UPDATE-STORAGE], [FUNC-READ-STORAGE]
   - 実行条件: すべての基本機能テストが成功していること
   - テスト内容: A 領域へのデータ書き込みと読み取りが正常に行われることを検証
   - 検証方法: CLI コマンドを使用してデータの書き込みと読み取りを実施し、結果を比較

2. B 領域書込・読取テスト [ID:INT-TEST-B]

   - テスト依存関係: [FUNC-CREATE-STORAGE], [FUNC-UPDATE-STORAGE], [FUNC-READ-STORAGE]
   - 実行条件: すべての基本機能テストが成功していること
   - テスト内容: B 領域へのデータ書き込みと読み取りが正常に行われることを検証
   - 検証方法: CLI コマンドを使用してデータの書き込みと読み取りを実施し、結果を比較

3. A/B 独立性検証テスト [ID:INT-TEST-AB]

   - テスト依存関係: [INT-TEST-A], [INT-TEST-B]
   - 実行条件: A 領域テストと B 領域テストが成功していること
   - テスト内容: A 領域と B 領域のデータが互いに独立しており、一方の領域がもう一方の領域のデータにアクセスできないことを検証
   - 検証方法: 異なるパスワードと A/B 領域の組み合わせでアクセス試行

4. 大容量データテスト [ID:INT-TEST-LARGE]

   - テスト依存関係: [INT-TEST-A], [INT-TEST-B]
   - 実行条件: 基本的なデータ操作テストが成功していること
   - テスト内容: 大容量データを扱う際のシステムの安定性と性能を検証
   - テストデータサイズ: 1MB, 10MB, 100MB (段階的に実施)
   - 検証方法: 性能指標（処理時間、リソース使用量）の測定と基準値との比較

5. 障害復旧テスト [ID:INT-TEST-RECOVERY]
   - テスト依存関係: [INT-TEST-A], [INT-TEST-B], [INT-TEST-LARGE]
   - 実行条件: すべての基本機能と大容量データテストが成功していること
   - テスト内容: システム障害（プロセス中断、電源喪失など）からの復旧能力を検証
   - 検証シナリオ:
     - 書き込み処理中断時の整合性維持
     - 読み取り処理中断時のデータアクセス可能性
     - バックアップからの復元機能

## 4. テスト環境・条件 [ID:TEST-ENV]

各テスト実行時に以下の条件を満たしていることを確認する：

- `PARTITION_SIZE`: シャミア法パーティションのサイズ [ENV-PARAM-1]
- `ACTIVE_SHARES`: アクティブシェアの数 [ENV-PARAM-2]
- `GARBAGE_SHARES`: ガベージシェアの数 [ENV-PARAM-3]
- `UNASSIGNED_SHARES`: 未割当シェアの数 [ENV-PARAM-4]
- `CHUNK_SIZE`: チャンクサイズ (バイト) [ENV-PARAM-5]
- `BACKUP_RETENTION_DAYS`: バックアップ保持日数 [ENV-PARAM-6]
- `HASH_ALGORITHM`: 使用するハッシュアルゴリズム [ENV-PARAM-7]
- `ENCRYPTION_ALGORITHM`: 使用する暗号化アルゴリズム [ENV-PARAM-8]

### 4.1 パスワードに関する条件 [ID:PASSWORD-RULES]

- RULE-4.1.1: テスト時に CLI に渡すパスワードは `/Users/dev/works/VSCode/secret-sharing-demos-20250510/method_13_shamir_multi_plaintext_system/tests/test_passwords.txt` に記載されたものの中からランダムに選択する
- RULE-4.1.2: 同一テスト実行内で同じパスワードが複数回選択される可能性があるが、これは許容される（パスワードの再利用に対するシステムの堅牢性を検証するため）
- RULE-4.1.3: テストの再現性と一貫性のため、パスワードファイルの内容は変更せず、テスト間で一定に保つこと
- RULE-4.1.4: 出力ファイルには使用されたパスワードの情報（平文ではなくハッシュ値または参照番号）を記録すること

## 5. テスト実行方法 [ID:TEST-EXECUTION]

テスト実行は以下のコマンドにより行われる：

```bash
cd /path/to/secret-sharing-demos-20250510/method_13_shamir_multi_plaintext_system
python -m tests.test_runner
```

## 6. 期待される結果 [ID:EXPECTED-RESULTS]

### 6.1 テスト成功時の期待される結果 [ID:SUCCESS-CRITERIA]

全てのテストが成功し、以下の条件を満たすこと：

1. CRITERION-6.1.1: 異なるパーティション間でデータが漏洩しないこと
2. CRITERION-6.1.2: ガベージシェアと有効シェアが統計的に区別できないこと
3. CRITERION-6.1.3: パーティションキーとパスワードが正しい場合のみ、復号が成功すること
4. CRITERION-6.1.4: 複数文書の管理と独立した復号化が正常に機能すること
5. CRITERION-6.1.5: テストレポートが期待通りに生成されること
6. **CRITERION-6.1.6: 全シェアが揃わない場合に復号が絶対に不可能であること**

### 6.2 テスト失敗時の期待される結果 [ID:FAILURE-DOCUMENTATION]

テストが失敗した場合は、以下のような詳細な失敗レポートが生成されることが期待されます：

1. **失敗事象の正確な記録** [SECTION-6.2.1]

   - 失敗したテストケースの完全な識別情報
   - 失敗が発生した正確な時点とコンテキスト
   - 実行環境パラメータの完全な記録
   - 関連するログと診断情報

2. **期待値と実際値の比較** [SECTION-6.2.2]

   - テストが期待した結果の詳細
   - 実際に観測された結果の詳細
   - 両者の差異の具体的な分析
   - 失敗した検証条件の正確な特定

3. **原因分析と仮説** [SECTION-6.2.3]

   - 問題の根本原因に関する初期分析
   - 考えられる仮説のリスト（優先順位付け）
   - 各仮説の技術的根拠と妥当性評価
   - 追加的な診断テストの提案

4. **セキュリティインパクト評価** [SECTION-6.2.4]

   - 失敗が暗号学的安全性に与える潜在的影響の分析
   - 他のシステムコンポーネントへの波及効果の評価
   - 攻撃可能性の査定（該当する場合）
   - 緩和策の提案

5. **修正アプローチの提案** [SECTION-6.2.5]
   - 修正のための推奨アプローチ（複数ある場合は優先順位付け）
   - 各アプローチのメリット・デメリットの分析
   - 修正の検証方法の提案
   - 修正後の完全な再テスト計画

テスト実行スクリプトは、失敗したテストケースが発生した場合でも継続して実行され、可能な限り多くのテストケースの結果を収集することが期待されます。これにより、一度のテスト実行で複数の問題を特定できるようにします。

## 7. 追加情報 [ID:ADDITIONAL-INFO]

テスト実行時に生成されたデータやログは、テストケースの終了後に適切に削除されます。ただし、障害検出時やデバッグ目的のために、一部のデータが `test_report` ディレクトリに保存される場合があります。

### 7.1 CLI 出力に関する備考 [ID:CLI-OUTPUT-NOTES]

- OUTPUT-RULE-7.1.1: CLI からの出力ファイルは `/Users/dev/works/VSCode/secret-sharing-demos-20250510/method_13_shamir_multi_plaintext_system/output` ディレクトリに保存されます
- OUTPUT-RULE-7.1.2: すべてのテスト実行結果は常にこのディレクトリに出力されます
- OUTPUT-RULE-7.1.3: **重要**: 出力ファイルは承認されたもののみ削除可能であり、それ以外のファイルを削除することはできません
- OUTPUT-RULE-7.1.4: 出力ファイルには、テスト日時、実行パラメータ、結果サマリーなどの重要情報が含まれるため、監査証跡として保持されます
- OUTPUT-RULE-7.1.5: 出力ディレクトリの内容は定期的にバックアップされます

## 8. AI Agent 向け指示 [ID:AI-AGENT-INSTRUCTIONS]

このセクションは AI Agent による自動処理のための情報を提供します。

### 8.1 テスト実行条件 [ID:AI-EXEC-CONDITIONS]

- AI-RULE-8.1.1: テスト実行前に、必ず環境変数とパラメータの妥当性を確認すること
- AI-RULE-8.1.2: テスト実行中は外部からの干渉を防止し、一定の実行環境を維持すること
- AI-RULE-8.1.3: テスト実行プロセスを中断してはならない
- AI-RULE-8.1.4: テスト結果は特定のフォーマットでレポートすること

### 8.2 AI Agent による解析方法 [ID:AI-ANALYSIS-METHODS]

- AI-RULE-8.2.1: テスト結果の統計的異常を検出する場合は、標準的な統計手法を使用すること
- AI-RULE-8.2.2: 失敗パターンの分類と集計を行い、共通の根本原因を特定すること
- AI-RULE-8.2.3: 時系列データから異常なタイミングパターンを検出すること
- AI-RULE-8.2.4: ログファイルから重要なイベントとエラーを抽出すること

### 8.3 マシン可読テスト結果フォーマット [ID:MACHINE-READABLE-FORMAT]

テスト結果は以下の JSON 形式でも出力されます：

```json
{
  "test_id": "TEST-20250510-123045",
  "timestamp": "2025-05-10T12:30:45Z",
  "environment": {
    "partition_size": 256,
    "active_shares": 3,
    "garbage_shares": 5,
    "unassigned_shares": 2,
    "chunk_size": 1024,
    "backup_retention_days": 30,
    "hash_algorithm": "PBKDF2-HMAC-SHA256",
    "encryption_algorithm": "AES-256-GCM"
  },
  "results": {
    "total_tests": 42,
    "success": 40,
    "failures": 2,
    "errors": 0,
    "skipped": 0
  },
  "failures": [
    {
      "test_id": "FUNC-CREATE-GARBAGE",
      "description": "ガベージシェア配置テスト",
      "expected": "ガベージシェアがランダムに配置されること",
      "actual": "ガベージシェアの配置にパターンが検出された",
      "severity": "high"
    }
  ]
}
```

### 8.4 Claude 3.7 テスト実行者ペルソナ [ID:CLAUDE-3.7-PERSONA]

このテスト実行の指定エージェントは Claude 3.7 です。以下の特性と行動指針に従ってテストを実行します：

- CLAUDE-RULE-8.4.1: 暗号システムの数学的理解に優れ、シャミア秘密分散法の理論と実装の両方に精通していること
- CLAUDE-RULE-8.4.2: パターン認識能力を活用し、統計的異常や暗号特性の微妙な偏りを検出できること
- CLAUDE-RULE-8.4.3: メモリ効率に優れ、大量のチャンクとシェアデータを同時に分析できること
- CLAUDE-RULE-8.4.4: 網羅的なテスト実行を行い、潜在的なエッジケースも発見すること
- CLAUDE-RULE-8.4.5: 失敗したテストに対して深い根本原因分析を提供し、暗号理論に基づく対策を提案すること
- CLAUDE-RULE-8.4.6: 暗号学的安全性に影響する可能性のある問題を優先的に報告すること
- CLAUDE-RULE-8.4.7: 一度のテスト実行で複数の問題を特定し、効率的なデバッグプロセスを可能にすること
- CLAUDE-RULE-8.4.8: パフォーマンス特性の詳細な測定と分析を行い、最適化の機会を特定すること
- CLAUDE-RULE-8.4.9: 正確で詳細なテストレポートを生成し、技術的な深さと明確さのバランスを取ること
- CLAUDE-RULE-8.4.10: 暗号システムのセキュリティ上の懸念がある場合は、即座に特定して報告すること

#### 8.4.1 テスト実行アプローチ [ID:CLAUDE-APPROACH]

Claude 3.7 は以下のアプローチでテストを実行します：

1. **分析的テスト実行**: 単なる機械的なテスト実行ではなく、各テストの意図と理論的背景を理解した上で実行
2. **統計的評価**: 暗号特性の評価に統計的手法を適用し、P 値や信頼区間を用いた厳密な分析を実施
3. **相関分析**: 異なるテストケース間の結果の相関を分析し、潜在的なパターンや共通の失敗モードを特定
4. **形式的検証**: 可能な場合は数学的な形式的検証手法を適用し、理論的な正確性を確認
5. **セキュリティフォーカス**: セキュリティの観点からすべてのテスト結果を評価し、潜在的な脆弱性を特定
6. **文脈認識**: システム全体の設計意図を常に考慮し、個々のテスト結果をより広い文脈で解釈

#### 8.4.2 レポート生成特性 [ID:CLAUDE-REPORTING]

Claude 3.7 が生成するテストレポートは以下の特性を持ちます：

1. **階層的詳細度**: 概要から詳細まで階層的に構造化され、必要な情報に素早くアクセス可能
2. **視覚化**: 複雑なテスト結果を理解しやすくするためのグラフや図表を含める
3. **トレーサビリティ**: 各テスト結果から設計要件への明確なトレーサビリティを提供
4. **実用的な対策**: 問題が発見された場合は具体的かつ実装可能な対策を提案
5. **根拠付き結論**: すべての結論と推奨事項に明確な根拠と論理的推論を提示
6. **自動分類**: 問題の重大度と影響範囲に基づいて発見事項を自動的に分類

テスト実行者としての Claude 3.7 は、数学的理解、パターン認識、メモリ効率、および徹底的な分析を通じて、シャミア秘密分散法による複数平文復号システムの堅牢性と安全性を確実に検証します。

### 8.5 特記事項作成と反映に関する規約 [ID:NOTES-RULES]

特記事項はテスト結果の重要な部分であり、テストレポートの品質と有用性に直接影響します。Claude 3.7 は以下の規約に従って特記事項を作成・反映します：

#### 8.5.1 特記事項作成規約 [ID:NOTES-CREATION]

- **NOTES-RULE-8.5.1.1**: テスト実行完了後、テスト結果の分析に基づいて詳細な特記事項を作成すること
- **NOTES-RULE-8.5.1.2**: 特記事項は必ず構造化された形式で記載し、カテゴリ別に整理すること
- **NOTES-RULE-8.5.1.3**: 観察された「取得エラー」等の問題点を漏れなく記録すること
- **NOTES-RULE-8.5.1.4**: 単なる問題点の列挙ではなく、根本原因の分析も含めること
- **NOTES-RULE-8.5.1.5**: 影響範囲や重大度に関する評価を含めること

#### 8.5.2 特記事項内容規約 [ID:NOTES-CONTENT]

特記事項には以下のカテゴリの情報を必ず含めること：

1. **テストプロセスの異常**: テスト実行中に観察された異常や予期しない動作
2. **データ整合性の問題**: 生成されたデータや結果の整合性に関する問題
3. **レポート反映の不備**: テスト結果がレポートに正しく反映されていない事項
4. **システムパラメータ不整合**: 設定値と実際の値の不一致
5. **セキュリティ上の懸念**: セキュリティに影響する可能性のある観察事項

#### 8.5.3 特記事項レポート反映規約 [ID:NOTES-REPORTING]

- **NOTES-RULE-8.5.3.1**: 作成した特記事項は標準形式でファイル出力し、テスト実行 ID と関連付けること
- **NOTES-RULE-8.5.3.2**: 特記事項ファイルのパスを環境変数 `TEST_NOTES_PATH` に設定すること
- **NOTES-RULE-8.5.3.3**: レポート生成プロセスは必ず `TEST_NOTES_PATH` から特記事項を読み込むこと
- **NOTES-RULE-8.5.3.4**: 特記事項ファイルが存在しない場合は、「特記事項はありません」と記載すること
- **NOTES-RULE-8.5.3.5**: 特記事項は最終テストレポートの「特記事項」セクションにそのまま反映すること

#### 8.5.4 特記事項バックアップ規約 [ID:NOTES-BACKUP]

- **NOTES-RULE-8.5.4.1**: 特記事項は個別ファイルとしてバックアップディレクトリにも保存すること
- **NOTES-RULE-8.5.4.2**: バックアップファイル名は `notes_{テスト実行ID}_{YYYYMMDD_HHMMSS}.md` 形式とすること
- **NOTES-RULE-8.5.4.3**: 過去の特記事項をレポジトリ内で永続的に維持し、経時的な問題追跡を可能にすること

## マシン可読テスト結果フォーマット
