# 準同型暗号マスキング方式の暗号化・復号テスト

## テスト概要

この実験では、準同型暗号マスキング方式を使って以下の 2 つのファイルを暗号化し、その後復号しました：

- `common/true-false-text/t.text`（真のファイル）
- `common/true-false-text/f.text`（偽のファイル）

暗号化されたファイルは、どちらの鍵（"true"または"false"）で復号するかによって、対応するファイルが復元されることを確認しました。どちらのキーが「正規」か「非正規」かはシステム上の区別ではなく、使用者の意図によって決まります。

## 暗号化と復号の所要時間

| プロセス           | ファイル                 | 実時間（秒） | ユーザー CPU 時間（秒） | システム CPU 時間（秒） |
| ------------------ | ------------------------ | ------------ | ----------------------- | ----------------------- |
| 暗号化             | t.text と f.text（同時） | 2.454        | 2.207                   | 0.115                   |
| 復号（True キー）  | t.text                   | 0.922        | 0.850                   | 0.064                   |
| 復号（False キー） | f.text                   | 0.920        | 0.850                   | 0.063                   |

## ファイルサイズと構造の変化

### 暗号化前後の比較

| ファイル       | 状態     | ファイルサイズ（バイト） | 行数 | 文字数 |
| -------------- | -------- | ------------------------ | ---- | ------ |
| t.text         | 暗号化前 | 294                      | 8    | 294    |
| f.text         | 暗号化前 | 296                      | 8    | 296    |
| 暗号化ファイル | 暗号化後 | 8,196                    | -    | -      |

### 復号前後の比較

| ファイル            | 状態                 | ファイルサイズ（バイト） | 行数 | 文字数 |
| ------------------- | -------------------- | ------------------------ | ---- | ------ |
| 暗号化ファイル      | 復号前               | 8,196                    | -    | -      |
| decrypted_true.txt  | 復号後（True キー）  | 294                      | 8    | 294    |
| decrypted_false.txt | 復号後（False キー） | 296                      | 8    | 296    |

## ファイル内容の検証

### t.text（真ファイル）

#### 暗号化前の内容

```
　　｡:🌸・｡･ﾟ🌸*.ﾟ｡
　･🌸.🌸.🌼🌸｡:*･.🌼
　.ﾟ🌼.｡;｡🌸.:*🌸.ﾟ｡🌸｡
　:*｡_🌸🌼｡_🌸*･_ﾟ🌸
　　＼ξ　＼　ζ／
　　　∧🎀∧＼ξ
　　（＊･ω･)／
　　c/　つ∀o
　　.しー-Ｊおめでとう～🎉
```

#### 復号後の内容（True キー）

```
　　｡:🌸・｡･ﾟ🌸*.ﾟ｡
　･🌸.🌸.🌼🌸｡:*･.🌼
　.ﾟ🌼.｡;｡🌸.:*🌸.ﾟ｡🌸｡
　:*｡_🌸🌼｡_🌸*･_ﾟ🌸
　　＼ξ　＼　ζ／
　　　∧🎀∧＼ξ
　　（＊･ω･)／
　　c/　つ∀o
　　.しー-Ｊおめでとう～🎉
```

### f.text（偽ファイル）

#### 暗号化前の内容

```
　　｡:🌸・｡･ﾟ🌸*.ﾟ｡
　･🌸.🌸.🌼🌸｡:*･.🌼
　.ﾟ🌼.｡;｡🌸.:*🌸.ﾟ｡🌸｡
　:*｡_🌸🌼｡_🌸*･_ﾟ🌸
　　＼ξ　＼　ζ／
　　　∧🎀∧＼ξ
　　（＊･ω･)／
　　c/　つ∀o
　　.しー-Ｊおめでとう～☠️
```

#### 復号後の内容（False キー）

```
　　｡:🌸・｡･ﾟ🌸*.ﾟ｡
　･🌸.🌸.🌼🌸｡:*･.🌼
　.ﾟ🌼.｡;｡🌸.:*🌸.ﾟ｡🌸｡
　:*｡_🌸🌼｡_🌸*･_ﾟ🌸
　　＼ξ　＼　ζ／
　　　∧🎀∧＼ξ
　　（＊･ω･)／
　　c/　つ∀o
　　.しー-Ｊおめでとう～☠️
```

## ファイル比較（オリジナルと復号後）

オリジナルと復号後のファイルを`cmp`コマンドで比較した結果、完全に一致していることを確認しました：

```
True files match perfectly
False files match perfectly
```

## 結論

この実験により、以下のことが確認できました：

1. 準同型暗号マスキング方式を使用して、単一の暗号文から異なる鍵を使い異なるファイルを復元することができます
2. 暗号化により、ファイルサイズは元のサイズの約 28 倍に増加しました（294/296 バイト → 8,196 バイト）
3. 復号後のファイルは、バイト単位で完全にオリジナルファイルと一致しました
4. どちらのキーが「正規」か「非正規」かはシステム上の区別ではなく、使用者の意図によって決まるという設計が正しく機能しています
5. 両方のファイルの違いは最後の絵文字（「🎉」vs「☠️」）のみであり、これによって真偽の状態を判別できます
