# シャミア秘密分散法による複数平文復号システム設計書

## 5. セキュリティ分析

### 5.1. 攻撃モデルと脆弱性分析

以下の攻撃モデルを考慮する：

1. **パッシブ攻撃者**：

   - 暗号化ファイルを入手可能
   - ソースコードを完全に把握
   - 統計的・構造的分析を試みる

2. **アクティブ攻撃者**：
   - 上記に加え、不正なパスワードでの復号を多数試行可能
   - タイミング攻撃などのサイドチャネル攻撃を試みる可能性

主な脆弱性と対策：

| 脆弱性               | 対策                                                       |
| -------------------- | ---------------------------------------------------------- |
| シェア識別攻撃       | パーティション空間の混在分散配置、統計的区別不可能性の確保 |
| ブルートフォース攻撃 | 強力な KDF の使用、十分な計算コスト設定                    |
| タイミング攻撃       | 条件分岐の排除、一定時間での処理実行                       |
| メタデータ分析       | メタデータの最小化、文書種別情報の排除                     |

### 5.2. マップデータの安全性

マップデータの安全性は以下の要素に依存する：

1. **鍵導出関数の強度**：

   - Argon2 または PBKDF2 など、実績のある KDF を使用
   - 十分なイテレーション回数と計算コスト
   - **KDF 推奨パラメータ**：
     - Argon2id: メモリ 64MB、イテレーション 3 回、並列度 4
     - PBKDF2-HMAC-SHA256: イテレーション回数 310,000 回以上、出力キー長 32 バイト
     - これらのパラメータは、OWASP 推奨値および業界標準に基づく 2024 年時点での推奨値
     - 実装環境のハードウェア性能に応じて調整し、約 1 秒の処理時間を目安とする

2. **決定論的生成**：

   - 同一パスワードからは常に同一マップを生成
   - パスワードがわずかに異なれば、全く異なるマップを生成

3. **予測不可能性**：
   - パスワードを知らなければマップ予測は計算量的に不可能
   - マップデータの部分的な漏洩が他の部分の予測に繋がらない

### 5.3. ソースコード漏洩時のセキュリティ

ケルクホフの原理に従い、ソースコード漏洩時でも以下の理由でセキュリティは保たれる：

1. **パスワード依存**：

   - セキュリティはパスワードの強度のみに依存
   - ソースコードからはパスワードを導出不可能

2. **パーティション空間の隠蔽**：

   - パーティション空間の割り当ては外部から観測不可能
   - 統計的に区別不可能な設計

3. **多段 MAP 方式の有効性**：
   - アルゴリズムを完全に理解していても、パスワードとパーティションマップキーがなければ復号不可能
   - ゴミデータと実データの区別が不可能

### 5.4. 未割当領域のセキュリティ強化

未割当領域がもたらすセキュリティ強化：

1. **統計的攻撃の難化**：

   - 攻撃者がファイル全体の 20-40%を無視できない
   - パターン認識による攻撃が困難になる

2. **将来の拡張性確保**：

   - 将来的な機能追加のための余白として機能
   - セキュリティモデルを変更せずに拡張可能

3. **攪乱効果**：
   - ランダムなゴミデータが攻撃者の分析を妨害
   - 有効データと無効データの区別を不可能にする
