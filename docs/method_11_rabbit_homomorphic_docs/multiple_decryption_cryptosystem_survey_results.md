# 複数復号暗号システム（Multiple-Decryption Cryptosystem）の実用実装調査

**調査日**: 2025 年 5 月 15 日
**調査者**: Claude 3.7 Sonnet

## 1. 利用可能なライブラリ/実装

### 1.1 主要なオープンソースライブラリ

#### Lenticrypt

- **概要**: 証明可能な否認可能暗号を提供する暗号システム
- **開発者**: Evan A. Sultanik
- **最終更新**: 2019 年 2 月
- **言語**: Python 3
- **ライセンス**: GPL-2.0
- **リポジトリ URL**: https://github.com/ESultanik/lenticrypt
- **特徴**:
  - 単一の暗号文から異なる鍵で異なる平文を生成できる
  - 暗号文サイズは最大平文サイズに比例（他の平文の数に比例しない）
  - 理論的に、任意の平文に対応する鍵が存在する可能性があるため、否認可能性が高い

#### Sunchoke Bed

- **概要**: シンプルな否認可能暗号
- **開発者**: icaswell
- **最終更新**: 不明（少ないコミット数から活発な開発はされていない）
- **言語**: Python
- **ライセンス**: 明記なし
- **リポジトリ URL**: https://github.com/icaswell/sunchoke_bed
- **特徴**:
  - 複数のメッセージを単一の暗号文にエンコード
  - 各メッセージは対応するパスワードでのみ復号可能
  - パズルゲームや秘密情報の共有に使用可能

#### RSA Deniable Encryption

- **概要**: 否認可能性を持つ RSA 暗号システム
- **開発者**: Victor M. Nieves
- **最終更新**: 定期的に更新
- **言語**: Python
- **ライセンス**: MIT
- **リポジトリ URL**: https://github.com/victormn/rsa-deniable-encryption
- **特徴**:
  - RSA ベースの否認可能暗号
  - 既存の暗号文と秘密鍵から新しい秘密鍵を生成し、別のメッセージを復号できる機能

### 1.2 Shamir 秘密分散に基づく実装

#### 多数の実装が存在

- **言語**: Python, Go, Rust, JavaScript, Java, C, C++など多数
- **主要リポジトリ**:
  - duncancmt/shamir: BIP-0039 ニーモニックと互換性のある実装
  - fletcher/c-sss: C による実装
  - elcritch/keyx: Elixir による実装
  - NillionNetwork/tinynmc: セキュアなマルチパーティ計算向け実装
  - jiang-zl/pyshamir: シンプルな Python 実装

#### 特徴

- 複数の当事者間で秘密を分散
- 閾値スキームを使用（n 個中 k 個の共有があれば復元可能）
- 暗号学的に安全な乱数生成に依存
- 多くの実装は標準暗号化アルゴリズムと組み合わせ可能

## 2. ソースコード耐久性

### 2.1 復号経路の特定可能性

#### Lenticrypt

- **耐久性**: 高
- **理由**: 暗号文中の異なる平文が共有バイトを使用するため、どの鍵がどの平文に対応するかを特定することが困難
- **エビデンス**: 開発者による主張と論文で検証（The International Journal of PoC||GTFO, Issue 0x04）
- **制限**: 実装の詳細を理解していれば理論上は解析可能だが、実際は非常に困難

#### Sunchoke Bed

- **耐久性**: 中
- **理由**: フラグメント化と乱数を使用するが、実装はやや単純
- **制限**: 開発者自身が「セキュリティ用途に特化していない」と注意

#### Shamir 秘密分散ベース

- **耐久性**: 中〜高（実装による）
- **理由**: 数学的に証明された情報理論的安全性を持つが、実装の詳細により漏洩リスクあり
- **エビデンス**: 多数の学術研究で検証されている原理に基づく

### 2.2 保護メカニズム

#### 共通手法

- 乱数生成器の使用
- 暗号文内での共有バイトまたはビット
- 鍵派生関数の使用
- 数学的変換（多項式補間など）

#### 実装別特徴

- **Lenticrypt**: 特殊な暗号文構造により復号経路を隠蔽
- **RSA Deniable**: 特殊な数学的特性を利用した衝突鍵生成
- **Shamir 方式**: 閾値以下の共有からは情報理論的に秘密を復元不可能

## 3. AES との組み合わせ

### 3.1 組み合わせアプローチ

#### 直接統合

- **概要**: AES 暗号化の鍵管理に複数復号機能を統合
- **実装例**: 明示的な実装は少ない
- **セキュリティ分析**: 形式的な分析は限定的

#### 階層的アプローチ

- **概要**: AES で暗号化した後、鍵を複数復号システムで管理
- **利点**: 標準 AES の強度を維持しながら複数復号機能を追加
- **欠点**: 実装が複雑化し、エラーリスクが増加

#### Shamir ベースの鍵管理

- **概要**: AES 鍵を Shamir 秘密分散で分散
- **実装例**: 多数存在（暗号鍵管理ソリューションとして）
- **セキュリティ分析**: 広く研究され、証明されている

### 3.2 ソースコード耐久性との関係

- **利点**: AES による標準的な暗号化を用いることで、内容の機密性を確保しつつ、鍵管理レイヤーのみで複数復号機能を実現可能
- **欠点**: 実装の複雑さが増し、バグやセキュリティホールのリスクが高まる

## 4. 実用性評価

### 4.1 本番利用事例

- **限定的**: 大規模な本番環境での利用事例は公開されていない
- **理由**: 新興技術であり、標準化されていない
- **用途**: 主に研究、教育、小規模なプライバシー保護ソリューション

### 4.2 パフォーマンス特性

#### Lenticrypt

- **暗号化速度**: 中程度
- **メモリ使用量**: 高い（全平文を処理する必要がある）
- **暗号文サイズ**: 最大平文サイズに比例

#### Shamir 秘密分散

- **暗号化速度**: 高い
- **メモリ使用量**: 低〜中程度
- **暗号文サイズ**: 分散数に比例して増加

### 4.3 スケーラビリティ

- **大規模データ**: 多くの実装は小〜中規模データ向けに最適化
- **分散処理**: 一部の実装はマルチスレッド/分散処理に対応
- **制限要因**: メモリ使用量と IO 処理が主なボトルネック

### 4.4 鍵管理の複雑さ

- **運用オーバーヘッド**: 中〜高
- **鍵配布**: 安全な鍵配布が必要
- **バックアップ**: 鍵損失リスクと回復メカニズムのバランスが重要

## 5. 実装アプローチ比較

### 5.1 手法別比較

#### 否認可能暗号ベース（Lenticrypt 等）

- **長所**: 強力な否認可能性、単一暗号文から複数平文
- **短所**: 実装が複雑、広範なセキュリティ検証の欠如
- **適用**: 高度なプライバシー要件がある限定的な状況

#### Shamir 秘密分散ベース

- **長所**: 数学的に証明された安全性、実装が比較的簡単
- **短所**: 純粋な複数復号でなく秘密共有に近い
- **適用**: 分散型の秘密管理、障害耐性が必要な状況

#### RSA ベース

- **長所**: 既存の RSA 知識が活用可能、標準暗号との親和性
- **短所**: 計算コストが高い、量子コンピュータに対する脆弱性
- **適用**: 既存 RSA インフラを活用したい状況

### 5.2 実装容易性

1. **Shamir 秘密分散**: 最も実装しやすく、多数のライブラリが存在
2. **AES+鍵管理の組み合わせ**: 既存ライブラリを組み合わせるため中程度の難易度
3. **Lenticrypt/否認可能暗号**: 実装が複雑で専門知識が必要

### 5.3 推奨アプローチ

#### 保管庫状態隠蔽ユースケース向け

**推奨**: Shamir 秘密分散と AES の組み合わせ

**実装手順**:

1. AES で機密データを暗号化
2. 暗号化に使用した AES 鍵を Shamir 秘密分散で分割
3. 閾値と共有数を安全要件に合わせて設定
4. 分散共有を安全に保管・配布

**根拠**:

- 実装が比較的容易で広く検証されている
- 標準的な暗号化アルゴリズム（AES）の強度を活用
- 柔軟な閾値設定が可能
- 多数の言語での実装が利用可能

## 6. 結論と推奨事項

### 6.1 総合評価

複数復号暗号システムは現在も発展中の技術分野であり、以下の特徴があります：

- **成熟度**: 研究段階から実装段階への移行中
- **標準化**: 広く受け入れられた標準が存在しない
- **実用性**: 特定のニッチなユースケースで有用
- **課題**: 実装の複雑さ、運用オーバーヘッド、セキュリティ検証の不足

### 6.2 推奨実装パス

1. **初期段階**:

   - Shamir 秘密分散ライブラリを使用したプロトタイピング
   - AES との基本的な統合

2. **高度化**:

   - セキュリティ要件に応じたカスタマイズ
   - パフォーマンス最適化
   - 厳格なセキュリティテスト

3. **運用考慮事項**:
   - 鍵管理プロトコルの確立
   - バックアップと復旧メカニズムの設計
   - ユーザー教育とドキュメント作成

### 6.3 今後の研究方向

- 標準暗号（AES 等）との統合のためのフレームワーク開発
- 実装のセキュリティ分析の標準化
- 量子耐性のある複数復号手法の研究
- 使いやすいライブラリとツールの開発

---

**注**: この調査は 2025 年 5 月時点の情報に基づいています。暗号技術は急速に発展しているため、実装前に最新の情報を確認することをお勧めします。
